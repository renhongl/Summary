/**
 * 使用单页面学习Redux
 */

import { createStore } from 'redux';

const toodList = [];
const ADD_TODO = 'ADD_TODO';
const store = createStore(reducer);

function main() {
    let unsubscribe = store.subscribe(() => {
        console.log(1);
        render(store.getState());
    });

    let addButton = document.querySelector('.addOneTodo');
    addButton.onclick = function() {
        let text = document.querySelector('.newTodo').value;
        store.dispatch(addTodo(text));
    };
}

function addTodo(text) {
    return {
        type: ADD_TODO,
        payload: text
    };
}

function render(todoList) {
    let ul = document.querySelector('ul');
    if(ul){
        ul.remove();
    }
    ul = document.createElement('ul');
    document.body.appendChild(ul);
    for(let todo of todoList) {
        let li = document.createElement('li');
        li.innerHTML = todo;
        ul.appendChild(li);
    }
}

function reducer (state = toodList, action) {
    switch (action.type) {
        case 'ADD_TODO':
            let newState = [];
            Object.assign(newState, state);
            newState.push(action.payload);
            return newState;
        default:
            return state;
    }
}

main();






